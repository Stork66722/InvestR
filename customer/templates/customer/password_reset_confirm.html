{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Set New Password - InvestR</title>
    <link rel="stylesheet" href="{% static 'css/sign_in.css' %}" />
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'images/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'images/favicon-16x16.png' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/apple-touch-icon.png' %}">
</head>
<body>
    <div class="page">
        <div class="container">
            {% if validlink %}
                <h2>Set New Password</h2>
                <p style="color: #6b7280; margin-bottom: 24px; text-align: center;">
                    Please enter your new password twice so we can verify you typed it correctly.
                </p>
                
                {% if form.errors %}
                    <div class="message error">
                        {% for field, errors in form.errors.items %}
                            {% for error in errors %}
                                {{ error }}<br>
                            {% endfor %}
                        {% endfor %}
                    </div>
                {% endif %}
                
                <form method="post">
                    {% csrf_token %}
                    
                    <input type="password" 
                           name="new_password1" 
                           placeholder="New Password" 
                           required
                           autocomplete="new-password">
                    
                    <input type="password" 
                           name="new_password2" 
                           placeholder="Confirm New Password" 
                           required
                           autocomplete="new-password">
                    
                    <div style="background: #ecfdf5; border: 1px solid #d1fae5; border-radius: 8px; padding: 12px; margin-bottom: 16px;">
                        <p style="font-size: 0.875rem; color: #047857; margin: 0;">
                            <strong>Password Requirements:</strong><br>
                            • At least 8 characters<br>
                            • Cannot be too similar to your username<br>
                            • Cannot be entirely numeric
                        </p>
                    </div>
                    
                    <button type="submit">Reset Password</button>
                    
                    <div class="actions">
                        <a href="{% url 'sign_in' %}">← Back to Sign In</a>
                    </div>
                </form>
            {% else %}
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 4rem; margin-bottom: 16px;">⚠️</div>
                    <h2>Reset Link Invalid</h2>
                </div>
                
                <div class="message error">
                    This password reset link is invalid or has expired.
                </div>
                
                <p style="color: #6b7280; margin: 24px 0; text-align: center; line-height: 1.6;">
                    Password reset links expire after 24 hours for security reasons.
                </p>
                
                <div style="text-align: center; margin-top: 32px;">
                    <a href="{% url 'password_reset' %}" 
                       style="display: inline-block; background: #16a34a; color: white; padding: 12px 32px; border-radius: 8px; text-decoration: none; font-weight: 600;">
                        Request New Reset Link
                    </a>
                </div>
                
                <div class="actions" style="margin-top: 24px;">
                    <a href="{% url 'sign_in' %}">← Back to Sign In</a>
                </div>
            {% endif %}
        </div>
    </div>
</body>
</html>